### What’s missing for full Option 3

### 1. **`frame_id` on `image_generation_jobs`** (recommended)

Option 3 assumed a **reverse link**: each job can point to the frame it’s for, so you get “all jobs for this frame” (regeneration history).

Right now only `frames.current_job_id` → jobs exists. There is no `image_generation_jobs.frame_id` → `frames(id)`.

**Suggestion:** Add a migration (e.g. 020 or an extra block in 019) that does:

```sql
ALTER TABLE image_generation_jobs
  ADD COLUMN frame_id UUID REFERENCES frames(id) ON DELETE SET NULL;
CREATE INDEX idx_image_jobs_frame ON image_generation_jobs(frame_id);
```

Then when you create a job for a frame, set `job.frame_id = frame.id`. That gives you:

- Regeneration history: “all jobs where `frame_id = X`”
- Optional: “latest completed job for this frame” even before approval

So: **019 matches Option 3 for the frames table; adding `frame_id` on jobs completes the “both” design (frames + jobs for tracking/history).**

### 2. **FK from `scenes.end_frame_id` → `frames(id)`** (optional but nice)

`scenes.end_frame_id` already exists (migration 003) with a comment that the FK would be added in a future migration. Now that `frames` exists, you can add:

```sql
ALTER TABLE scenes
  ADD CONSTRAINT fk_scenes_end_frame
  FOREIGN KEY (end_frame_id) REFERENCES frames(id) ON DELETE SET NULL;
```

(Only if your Postgres version and deployment allow adding an FK to an existing column; if there’s existing data, ensure it’s valid or backfill first.)

This doesn’t change the Option 3 design; it just enforces referential integrity for the “scene’s final frame” pointer.

---

## Naming note

You use **`current_job_id`**; the earlier recommendation used **`approved_job_id`**. As long as the app only sets it when a job is approved (or when it’s the single “current” completed result for that frame), the meaning is the same. If you ever need to distinguish “job currently running” from “job that produced the approved image,” `approved_job_id` would be clearer; otherwise `current_job_id` is fine.

---

## Summary

- **019_frames_table.sql** matches Option 3 for the **frames** side: status/approval, current image pointer (`current_job_id`), one row per (shot, frame_type), continuity via `previous_frame_id`, jobs unchanged as the execution log.
- To fully match “Option 3 (Both)” and get regeneration history per frame, add **`frame_id`** on **`image_generation_jobs`** (in 019 or a follow-up migration).
- Optionally add the **FK** from **`scenes.end_frame_id`** to **`frames(id)`** now that the table exists.