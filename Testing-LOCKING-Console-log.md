ğŸ“¥ Loading stage state from API...
useStageState.ts:104 â­ï¸ Skipping auto-save - first render or loading: 
{isFirstRender: true, isLoading: true}
useStageState.ts:75 âœ… Stage state loaded: 
{id: '0f9f4262-6a6c-4c21-ace4-aa81bb9bdecc', branch_id: 'f7da294a-2248-4360-8a87-5639623c87a2', stage_number: 1, version: 28, status: 'locked', â€¦}
useStageState.ts:85 âœ… Load stage state completed
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
useStageState.ts:64 â­ï¸ Skipping load - projectId is new or invalid: undefined
useStageState.ts:104 â­ï¸ Skipping auto-save - first render or loading: 
{isFirstRender: true, isLoading: true}
useStageState.ts:111 â­ï¸ Skipping auto-save - invalid projectId: undefined
useStageState.ts:70 ğŸ“¥ Loading stage state from API...
useStageState.ts:104 â­ï¸ Skipping auto-save - first render or loading: 
{isFirstRender: true, isLoading: true}
useStageState.ts:75 âœ… Stage state loaded: 
{id: '0f9f4262-6a6c-4c21-ace4-aa81bb9bdecc', branch_id: 'f7da294a-2248-4360-8a87-5639623c87a2', stage_number: 1, version: 28, status: 'locked', â€¦}
useStageState.ts:85 âœ… Load stage state completed
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
chunk-R6S4VRB5.js?v=c34f0c4f:521 Warning: validateDOMNesting(...): <button> cannot appear as a descendant of <button>.
    at button
    at _c (http://localhost:8080/src/components/ui/button.tsx:52:55)
    at http://localhost:8080/node_modules/.vite/deps/chunk-JFWPD3MN.js?v=c34f0c4f:79:13
    at http://localhost:8080/node_modules/.vite/deps/chunk-JFWPD3MN.js?v=c34f0c4f:56:13
    at http://localhost:8080/node_modules/.vite/deps/chunk-JNSMXY3T.js?v=c34f0c4f:43:13
    at http://localhost:8080/node_modules/.vite/deps/chunk-53YRBMSC.js?v=c34f0c4f:88:13
    at Provider (http://localhost:8080/node_modules/.vite/deps/chunk-PLT6GTVM.js?v=c34f0c4f:38:15)
    at Dialog (http://localhost:8080/node_modules/.vite/deps/chunk-53YRBMSC.js?v=c34f0c4f:52:5)
    at button
    at _c (http://localhost:8080/src/components/ui/button.tsx:52:55)
    at http://localhost:8080/node_modules/.vite/deps/chunk-JFWPD3MN.js?v=c34f0c4f:79:13
    at http://localhost:8080/node_modules/.vite/deps/chunk-JFWPD3MN.js?v=c34f0c4f:56:13
    at http://localhost:8080/node_modules/.vite/deps/chunk-JNSMXY3T.js?v=c34f0c4f:43:13
    at http://localhost:8080/node_modules/.vite/deps/chunk-JFWPD3MN.js?v=c34f0c4f:79:13
    at http://localhost:8080/node_modules/.vite/deps/chunk-JFWPD3MN.js?v=c34f0c4f:56:13
    at http://localhost:8080/node_modules/.vite/deps/chunk-JNSMXY3T.js?v=c34f0c4f:43:13
    at http://localhost:8080/node_modules/.vite/deps/chunk-27XVVZ7U.js?v=c34f0c4f:1955:13
    at http://localhost:8080/node_modules/.vite/deps/@radix-ui_react-popover.js?v=c34f0c4f:118:13
    at Provider (http://localhost:8080/node_modules/.vite/deps/chunk-PLT6GTVM.js?v=c34f0c4f:38:15)
    at Provider (http://localhost:8080/node_modules/.vite/deps/chunk-PLT6GTVM.js?v=c34f0c4f:38:15)
    at Popper (http://localhost:8080/node_modules/.vite/deps/chunk-27XVVZ7U.js?v=c34f0c4f:1947:11)
    at Popover (http://localhost:8080/node_modules/.vite/deps/@radix-ui_react-popover.js?v=c34f0c4f:66:5)
    at div
    at StyleCapsuleSelector (http://localhost:8080/src/components/styleCapsules/StyleCapsuleSelector.tsx:34:40)
    at section
    at div
    at MotionDOMComponent (http://localhost:8080/node_modules/.vite/deps/framer-motion.js?v=c34f0c4f:5455:40)
    at div
    at Stage1InputMode (http://localhost:8080/src/components/pipeline/Stage1InputMode.tsx?t=1768267685939:112:35)
    at div
    at ProjectView (http://localhost:8080/src/pages/ProjectView.tsx?t=1768267685939:70:42)
    at main
    at div
    at MainLayout (http://localhost:8080/src/components/layout/MainLayout.tsx:25:30)
    at ProtectedRoute (http://localhost:8080/src/components/auth/ProtectedRoute.tsx:25:34)
    at RenderedRoute (http://localhost:8080/node_modules/.vite/deps/react-router-dom.js?v=c34f0c4f:4088:5)
    at Routes (http://localhost:8080/node_modules/.vite/deps/react-router-dom.js?v=c34f0c4f:4558:5)
    at Router (http://localhost:8080/node_modules/.vite/deps/react-router-dom.js?v=c34f0c4f:4501:15)
    at BrowserRouter (http://localhost:8080/node_modules/.vite/deps/react-router-dom.js?v=c34f0c4f:5247:5)
    at Provider (http://localhost:8080/node_modules/.vite/deps/chunk-PLT6GTVM.js?v=c34f0c4f:38:15)
    at TooltipProvider (http://localhost:8080/node_modules/.vite/deps/@radix-ui_react-tooltip.js?v=c34f0c4f:64:5)
    at QueryClientProvider (http://localhost:8080/node_modules/.vite/deps/@tanstack_react-query.js?v=c34f0c4f:2934:3)
    at App
chunk-53YRBMSC.js?v=c34f0c4f:340 Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.
useStageState.ts:70 ğŸ“¥ Loading stage state from API...
useStageState.ts:104 â­ï¸ Skipping auto-save - first render or loading: 
{isFirstRender: true, isLoading: true}
useStageState.ts:79 â„¹ï¸ No existing stage state found - using initial content
useStageState.ts:85 âœ… Load stage state completed
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
2
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
5
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
33
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
3
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
Stage1InputMode.tsx:201 ğŸ” [DEBUG] Stage 1 - Processing input with: 
{selectedMode: 'expansion', selectedProjectType: 'narrative', selectedRating: 'PG-13', selectedGenres: Array(2), targetLength: Array(2), â€¦}
Stage1InputMode.tsx:223 ğŸ” [DEBUG] Stage 1 - Processed input result: 
{mode: 'expansion', primaryContentLength: 353, contextFilesCount: 0, projectParams: {â€¦}}
Stage1InputMode.tsx:236 ğŸ” [DEBUG] Stage 1 - Updated content keys: 
(10) ['selectedMode', 'selectedProjectType', 'selectedRating', 'selectedGenres', 'targetLength', 'tonalPrecision', 'writingStyleCapsuleId', 'uploadedFiles', 'ideaText', 'processedInput']
Stage1InputMode.tsx:240 ğŸ” [DEBUG] Stage 1 - Saving stage state for project: a69a9049-97d4-4a66-9703-b5d360bc8d26
stageStateService.ts:93 âœ… Auth session found, making API request...
stageStateService.ts:101 ğŸ“¤ Request body: 
{content: {â€¦}, status: 'draft', regenerationGuidance: ''}
stageStateService.ts:112 ğŸ“¥ Response status: 200
stageStateService.ts:121 âœ… Save successful: 
{id: '6501f850-9450-4775-ae76-ab8e27272a91', branch_id: '14f92570-8910-4534-b438-e90a63ace5af', stage_number: 1, version: 1, status: 'draft', â€¦}
Stage1InputMode.tsx:245 ğŸ” [DEBUG] Stage 1 - Stage state saved successfully
Stage1InputMode.tsx:248 ğŸ” [DEBUG] Stage 1 - Cancelling pending auto-saves before completion
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
useStageState.ts:70 ğŸ“¥ Loading stage state from API...
useStageState.ts:104 â­ï¸ Skipping auto-save - first render or loading: 
{isFirstRender: true, isLoading: true}
useStageState.ts:79 â„¹ï¸ No existing stage state found - using initial content
useStageState.ts:85 âœ… Load stage state completed
useStageState.ts:122 ğŸ”„ Auto-save triggered for stage 2 with content keys: 
(2) ['variations', 'activeVariation']
stageStateService.ts:185 â³ Auto-save scheduled in 1000ms
Stage2Treatment.tsx:142 ğŸ” [DEBUG] Starting generateInitialTreatments for projectId: a69a9049-97d4-4a66-9703-b5d360bc8d26
Stage2Treatment.tsx:145 ğŸ” [DEBUG] Fetching Stage 1 state...
Stage2Treatment.tsx:148 ğŸ” [DEBUG] Stage 1 state received: 
{exists: true, id: '10f77e56-5de9-45a0-8fa6-c21f0e9911da', stageNumber: 1, version: 2, status: 'locked', â€¦}
Stage2Treatment.tsx:164 ğŸ” [DEBUG] Stage 1 processed input details: 
{mode: 'expansion', primaryContentLength: 353, contextFilesCount: 0, projectParams: {â€¦}}
Stage2Treatment.tsx:175 ğŸ” [DEBUG] Calling treatmentService.generateTreatments with: 
{processedInput: {â€¦}, projectId: 'a69a9049-97d4-4a66-9703-b5d360bc8d26'}
treatmentService.ts:42 ğŸ” [DEBUG] treatmentService.generateTreatments - Processing request: 
{projectId: 'a69a9049-97d4-4a66-9703-b5d360bc8d26', processedInputKeys: Array(4), mode: 'expansion', primaryContentLength: 353, contextFilesCount: 0, â€¦}
treatmentService.ts:77 ğŸ” [DEBUG] Template variables being sent: 
{templateName: 'treatment_expansion', variableKeys: Array(10), variables: {â€¦}}
treatmentService.ts:93 ğŸ” [DEBUG] Full LLM request: 
{templateName: 'treatment_expansion', variables: {â€¦}, metadata: {â€¦}}
stageStateService.ts:93 âœ… Auth session found, making API request...
stageStateService.ts:101 ğŸ“¤ Request body: 
{content: {â€¦}, status: 'draft', regenerationGuidance: ''}
stageStateService.ts:112 ğŸ“¥ Response status: 200
stageStateService.ts:121 âœ… Save successful: 
{id: 'dad920b8-266f-4c50-9dfe-05b40e419d73', branch_id: '14f92570-8910-4534-b438-e90a63ace5af', stage_number: 2, version: 1, status: 'draft', â€¦}
stageStateService.ts:175 âœ… Auto-save completed successfully
useStageState.ts:128 ğŸ“‹ Auto-save callback: 
{stage: 2, success: true, error: undefined}
treatmentService.ts:255 ğŸ” [TREATMENT PARSE] Input type: string
treatmentService.ts:256 ğŸ” [TREATMENT PARSE] Input preview: ```json
{
  "treatments": [
    {
      "variant_id": 1,
      "prose": "The asphalt gleams under a bruised twilight sky, reflecting the predatory headlights of two sleek, obsidian self-driving cars. 
treatmentService.ts:268 ğŸ” [TREATMENT PARSE] Removing markdown code block markers
treatmentService.ts:274 ğŸ” [TREATMENT PARSE] Cleaned content preview: {
  "treatments": [
    {
      "variant_id": 1,
      "prose": "The asphalt gleams under a bruised 
treatmentService.ts:280 ğŸ” [TREATMENT PARSE] Successfully parsed JSON string
treatmentService.ts:312 âœ… [TREATMENT PARSE] Found treatments array with 3 items
treatmentService.ts:339 âœ… [TREATMENT PARSE] Variation 1 parsed: 
{contentLength: 3722, structuralEmphasis: 'This variation focuses on the escalating digital câ€¦tragedy of their love in a human-centric reality.', isString: true}
treatmentService.ts:339 âœ… [TREATMENT PARSE] Variation 2 parsed: 
{contentLength: 3742, structuralEmphasis: 'This variation emphasizes the contrast between theâ€¦ on human interaction they can no longer solicit.', isString: true}
treatmentService.ts:339 âœ… [TREATMENT PARSE] Variation 3 parsed: 
{contentLength: 3754, structuralEmphasis: 'This variation begins with a controlled, scientifiâ€¦isolation in a world that cannot comprehend them.', isString: true}
Stage2Treatment.tsx:200 ğŸ” [STAGE2 UI] Initial variation content: 
{isString: true, contentType: 'string', contentLength: 3722}
useStageState.ts:140 ğŸ§¹ Cleaning up auto-save for: a69a9049-97d4-4a66-9703-b5d360bc8d26 2
useStageState.ts:122 ğŸ”„ Auto-save triggered for stage 2 with content keys: 
(5) ['variations', 'activeVariation', 'processedInput', 'langsmithTraceId', 'promptTemplateVersion']
stageStateService.ts:185 â³ Auto-save scheduled in 1000ms
Stage2Treatment.tsx:122 ğŸ” [STAGE2 UI] Setting editable content: 
{isString: true, contentType: 'string', contentLength: 3722}
stageStateService.ts:93 âœ… Auth session found, making API request...
stageStateService.ts:101 ğŸ“¤ Request body: 
{content: {â€¦}, status: 'draft', regenerationGuidance: ''}
stageStateService.ts:112 ğŸ“¥ Response status: 200
stageStateService.ts:121 âœ… Save successful: 
{id: 'ee5480c8-ac8d-45bc-ac51-e2de9a559170', branch_id: '14f92570-8910-4534-b438-e90a63ace5af', stage_number: 2, version: 2, status: 'draft', â€¦}
stageStateService.ts:175 âœ… Auto-save completed successfully
useStageState.ts:128 ğŸ“‹ Auto-save callback: 
{stage: 2, success: true, error: undefined}


âœ… Stage state loaded: {id: '10f77e56-5de9-45a0-8fa6-c21f0e9911da', branch_id: '14f92570-8910-4534-b438-e90a63ace5af', stage_number: 1, version: 2, status: 'locked',Â â€¦}branch_id: "14f92570-8910-4534-b438-e90a63ace5af"content: {ideaText: "2 self driving cars race eachother, but then they â€¦ no one can hear them, as people don't speak wifi", selectedMode: 'expansion', targetLength: Array(2), uploadedFiles: Array(0), processedInput: {â€¦},Â â€¦}created_at: "2026-01-13T02:00:01.34762+00:00"created_by: "fa58ace1-ae7e-4dd8-ab54-1fbe453701f2"final_prompt: ""id: "10f77e56-5de9-45a0-8fa6-c21f0e9911da"inherited_from_stage_id: "6501f850-9450-4775-ae76-ab8e27272a91"langsmith_trace_id: nullprompt_template_version: ""regeneration_guidance: ""stage_number: 1status: "locked"version: 2[[Prototype]]: Object
useStageState.ts:85 âœ… Load stage state completed
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
2useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
Stage1InputMode.tsx:201 ğŸ” [DEBUG] Stage 1 - Processing input with: {selectedMode: 'expansion', selectedProjectType: 'narrative', selectedRating: 'PG-13', selectedGenres: Array(2), targetLength: Array(2),Â â€¦}
Stage1InputMode.tsx:223 ğŸ” [DEBUG] Stage 1 - Processed input result: {mode: 'expansion', primaryContentLength: 353, contextFilesCount: 0, projectParams: {â€¦}}
Stage1InputMode.tsx:236 ğŸ” [DEBUG] Stage 1 - Updated content keys: (10)Â ['ideaText', 'selectedMode', 'targetLength', 'uploadedFiles', 'processedInput', 'selectedGenres', 'selectedRating', 'tonalPrecision', 'selectedProjectType', 'writingStyleCapsuleId']
Stage1InputMode.tsx:240 ğŸ” [DEBUG] Stage 1 - Saving stage state for project: a69a9049-97d4-4a66-9703-b5d360bc8d26
stageStateService.ts:93 âœ… Auth session found, making API request...
stageStateService.ts:101 ğŸ“¤ Request body: {content: {â€¦}, status: 'draft', regenerationGuidance: ''}
stageStateService.ts:112 ğŸ“¥ Response status: 200
stageStateService.ts:121 âœ… Save successful: {id: '3ae09bfd-d132-47d4-a9d1-cd8315c9ffa4', branch_id: '14f92570-8910-4534-b438-e90a63ace5af', stage_number: 1, version: 3, status: 'locked',Â â€¦}
Stage1InputMode.tsx:245 ğŸ” [DEBUG] Stage 1 - Stage state saved successfully
Stage1InputMode.tsx:248 ğŸ” [DEBUG] Stage 1 - Cancelling pending auto-saves before completion
useStageState.ts:116 â­ï¸ Skipping auto-save - autoSave disabled
useStageState.ts:70 ğŸ“¥ Loading stage state from API...
useStageState.ts:104 â­ï¸ Skipping auto-save - first render or loading: {isFirstRender: true, isLoading: true}
useStageState.ts:75 âœ… Stage state loaded: {id: 'ee5480c8-ac8d-45bc-ac51-e2de9a559170', branch_id: '14f92570-8910-4534-b438-e90a63ace5af', stage_number: 2, version: 2, status: 'draft',Â â€¦}
useStageState.ts:85 âœ… Load stage state completed
useStageState.ts:122 ğŸ”„ Auto-save triggered for stage 2 with content keys: (5)Â ['variations', 'processedInput', 'activeVariation', 'langsmithTraceId', 'promptTemplateVersion']
stageStateService.ts:185 â³ Auto-save scheduled in 1000ms
Stage2Treatment.tsx:122 ğŸ” [STAGE2 UI] Setting editable content: {isString: true, contentType: 'string', contentLength: 3722}
stageStateService.ts:93 âœ… Auth session found, making API request...
stageStateService.ts:101 ğŸ“¤ Request body: {content: {â€¦}, status: 'draft', regenerationGuidance: ''}
stageStateService.ts:112 ğŸ“¥ Response status: 200
stageStateService.ts:121 âœ… Save successful: {id: '44bd643d-089c-47db-a572-9eeab2b5f640', branch_id: '14f92570-8910-4534-b438-e90a63ace5af', stage_number: 2, version: 3, status: 'draft',Â â€¦}
stageStateService.ts:175 âœ… Auto-save completed successfully
useStageState.ts:128 ğŸ“‹ Auto-save callback: {stage: 2, success: true, error: undefined}